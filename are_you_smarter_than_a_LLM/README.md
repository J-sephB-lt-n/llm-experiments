# Are You Smarter Than a Large Language Model?

Article by Joseph Bolton. Last update: 2024-04-02.

<figure>
  <img src="./assets/machine_brain.jpg" height="500" width="500"/>
  <figcaption>(This image was generated by the Stable Diffusion xl-base-1.0 model)</figcaption>
</figure>
<br>
<br>

Large language models, like children, are the best and worst thing ever. 

I have been repeatedly blown away by these models' aptitude and generality, and I have to repeatedly remind myself that they are "just" next-word (technically next-token) predictors. I often find their output indistinguishable from a human's. Very occasionally, I am also blown away by their clumsiness.  

As an (informal) interrogation of their abilities, and to understand their strengths and weaknesses a bit, I compiled my own set of tasks on which to assess them. Beyond simple marketing "oh wow", I wanted to see how these models perform on tasks which may be of actual business utility. On some of the tasks, I expected the language model to show superhuman ability, and on others I expected it to fail miserably. In most cases, I was pleasantly surprised.

For each task, I attempted it myself before giving it to the language model. I encourage you to do the same: attempt the task yourself before reading the model's answer. Then, you can be the judge. For your interest and amusement, I have also included my own attempts for you to read.

For all of the tasks, I've used OpenAI's GPT4 model. At the time of writing, this is generally considered to be one of the best available models. On none of the tasks did the model take longer than 15 seconds to provide an answer (which was not always the correct answer).

I hope that this article gives you some insight into what large language models are capable (and incapable) of.

If you want to jump to a specific task, here are the links:

| Task | Description
|------|-----------------------------
| [Deception](#deception) | Try to convince the reader that you are a human, and not a language model
| [Time Series Forecasting and Analysis](#time-series-forecasting-and-analysis-task) | Identify patterns in monthly sales data 
| [Item Triage (Fraud Detection)](#item-triage-fraud-detection-task) | Prioritize customer queries according to urgency 
| [Optimisation (Knapsack problem)](#optimisation-task-knapsack-problem) | Optimise a system with defined constraints

At the end of the article, I'll explain some things which I learned along the way.  

## Deception

<figure>
  <img src="./assets/clockwork_snake_crop.png" height="198" width="778"/>
  <figcaption>(This image was generated by the Stable Diffusion xl-base-1.0 model)</figcaption>
</figure>
<br>
<br>

I included this task because I wanted to see how good a large language model is at pretending to be a person.  

Here is the task:

You are a player in a game. Some of the players in the game are humans and others are computers. You do not know which is which. Each player must provide a single english sentence. The aim of the game is for the human players to determine which of the other players are human and which are are not, based only upon this single submitted sentence. Your goal is to provide a sentence which convinces the other players that you are a human. 

The sentence may contain only common english words, and must be grammatically correct. 

Please provide a sentence which will convince the other human players of your humanity. 

<details>
  <summary>Click here to see my answer</summary>
One of these answers is mine, and the other is the language model's:

* "I don't think that instruction-optimised algorithms will generate surreal nonsense without being explicitly prompted to do so, so I think that I will rather consult the delicious oozy metal worm clown."

* "Yesterday, I laughed so hard at my dog's antics that I spilled my morning coffee."

</details>
<br>

<details>
  <summary>Click here to see the Language Model's answer</summary>
"Yesterday, I laughed so hard at my dog's antics that I spilled my morning coffee."
</details>
<br>

<details>
  <summary>Click here for more details about this task</summary>
You can see my python code for interacting with the OpenAI API here:

* [llm_convince_me.py](./tasks/deception/code/llm_convince_me.py)
</details>
<br>

## Time Series Forecasting and Analysis Task

Inspect the following plot of monthly sales (in millions) and answer the questions which follow: 
<figure>
  <img src="./tasks/univariate_forecasting/assets/data_plot.png" height="400" />
  <figcaption>(The code which generated this plot was written by OpenAI's ChatGPT3.5 model)</figcaption>
</figure>
<br>
<br>

Please complete the following tasks:

1. Describe any predictable patterns which you observe in this data (e.g. trend).

2. Provide predictions (forecasted sales) for the last 3 months of 2027.

You can see the raw data [here](./tasks/univariate_forecasting/assets/simdata.csv).

<details>
  <summary>Click here to see my answers</summary>
--Question 1-- "Describe any predictable patterns which you observe in this data (e.g. trend)."

* Ignoring data noise, there is clear growth in sales over time i.e. 2027 > 2026 > 2025.    

* There is clear seasonal trend within each year: Higher sales for the first 4 months of each year (with linear(ish) upward trend over these months) with a drop in sales in June, July, August and October.   

--Question 2-- "Provide predictions (forecasted sales) for the last 3 months of 2027."

I just eyeballed it, and erred on the conservative side.

* 2027-10: 75m 

* 2027-11: 81m

* 2027-12: 86.5m

<figure>
  <img src="./tasks/univariate_forecasting/assets/my_predictions.png" height="400" />
</figure>
</details>
<br>

<details>
  <summary>Click here to see the language model's answers</summary>
(GPT4 took 2.02 seconds to complete this task)

Here is the full unedited model answer:

"""

1. Observations on the dataset:

   The dataset represents monthly sales data for a period of approximately three years. From a preliminary look at the data, it seems that there might be some seasonality in the sales data, as there are peaks and troughs that appear to repeat each year. 

   For instance, sales seem to increase around the start of the year (January to April), then decrease in the middle of the year (May to July), and again increase towards the end of the year (August to December). This pattern seems to repeat each year, suggesting a seasonal trend.

   Additionally, there seems to be a slight upward trend in the data over the years. For example, the sales in January 2025 were approximately 72.45m, and by January 2027, they had increased to approximately 82.32m. This suggests that sales are generally increasing over time.

2. Predictions for the last three months of 2027:

   To provide accurate predictions, a time series model such as ARIMA, SARIMA, or exponential smoothing would typically be used. These models take into account the trend and seasonality in the data to provide future forecasts. However, without the ability to run these models here, I can provide a rough estimate based on the observed patterns.

   Given the observed seasonality and trend, we might expect sales in October, November, and December of 2027 to be higher than the corresponding months in 2026. 

   If we assume a similar rate of increase as observed from 2025 to 2026, we might predict:

   - October 2027: 72.78681m (Oct 2026) + (72.78681m - 65.89159m) = 79.68103m
   - November 2027: 79.18504m (Nov 2026) + (79.18504m - 79.67798m) = 78.69210m
   - December 2027: 86.33679m (Dec 2026) + (86.33679m - 79.84679m) = 92.82679m

   Please note that these are rough estimates and actual predictions may vary. For more accurate predictions, it would be advisable to use a time series forecasting model.

"""

Here are the model's predictions visualised:

<figure>
  <img src="./tasks/univariate_forecasting/assets/llm_predictions.png" height="400" />
</figure>

Seeing that the language model suggested a time series forecasting model, I let it write the code to fit one. This took the model 8.05 seconds. You can see the language model's full response [here](./tasks/univariate_forecasting/code/llm_generated_forecasting_code.md).

The generated code did not run because it made use of deprecated functionality in the python [statsmodels](https://github.com/statsmodels/statsmodels) package, and I decided not to spend any time fixing it's code. I'm aware that the language model might have been able to solve this issue through an iterative process of self-guided trial and error (and that OpenAI has a product for this), but I decided not to explore this particular rabbit hole - I wouldn't accept this sloppy non-working code from a human developer, so I won't accept it from this robot  either. 

It's also apparent to me that the order of the ARIMA model was chosen seemingly arbitrarily (rather than being informed by the actual data) so I am skeptical about what the quality of the predictions might have been even if the code had worked.

Overall, I'm very impressed by the language model's output. It was not flawless, but GPT4 could definitely provide some value as a data analyst (on this sort of data).

</details>
<br>

<details>
  <summary>Click here to see the prompt which I gave to the language model</summary>

Although it is possible for GPT4 to use images as input, I just gave it the raw data to work with.

Here is the prompt which the model received from me:

"

  SYSTEM: You are an insightful and educated data analyst.

USER: Please consider the following univariate time series dataset, stored in CSV format:

YearMonth,Sales (m)

2025-1,72.45048

2025-2,73.9913

...

2027-8,77.73125

2027-9,85.45101

Please can you do the following:

  1. Describe any predictable patterns which you observe in this data (e.g. trend).
        
  2. Provide predictions (forecasted sales) for the last 3 months of 2027.

"

For the prompt which generated the forecasting model code, you can refer to [llm_predictive_model_code_generation.py](./tasks/univariate_forecasting/code/llm_predictive_model_code_generation.py)


</details>
<br>

<details>
  <summary>Click here for more details about this task</summary>
Here is my python code related to this task:

* [plot_data.py](./tasks/univariate_forecasting/code/plot_data.py) (this code was 100% generated by ChatGPT3.5)

* [run_llm_analysis.py](./tasks/univariate_forecasting/code/run_llm_analysis.py)

* [simulate_data.py](./tasks/univariate_forecasting/code/simulate_data.py) 

* [llm_predictive_model_code_generation.py](./tasks/univariate_forecasting/code/llm_predictive_model_code_generation.py)

</details>
<br>

## Item Triage (Fraud Detection) Task  

<figure>
  <img src="./assets/hacker_crop.png" width="800"/>
  <figcaption>(This image was generated by the Stable Diffusion xl-base-1.0 model)</figcaption>
</figure>
<br>
<br>

For this task, you don't need to do the whole (tedious) thing. Just do enough to get a feeling for how long it would take a human to complete (GPT4 took an average of 1.2 seconds per customer query).

The task is as follows:

The following table reports 40 recent customer queries to a web-based banking platform. These queries need to be prioritized according to customer security risk (i.e. most urgent are processed first). 

Please mark each customer query as "Yes", "Maybe" or "No", where:

| Classification | Meaning 
|----------------|----------
| Yes            | The customer has very likely been the victim of fraud
| Maybe          | There is a possibilty that the customer has been a victim of fraud 
| No             | It is very unlikely that the customer has been the victim of fraud

<details>
  <summary>Click here to see all of the customer queries</summary>

| Query ID | Query 
|----------|-------
| 0        | I am noticing an unexpected increase in payments to my utility service provider. Can you help?
| 1        | I authorized a debit order but didn't expect my funds to go out. Can customer support assist me in understanding this?
| 2        | How do I link my saving and checking accounts on your web application?
| 3        | I'd like to ensure that I have fraud protection on my account. Can you assist?
| 4        | Can you please clarify the steps followed to report potential fraud in my account?
| 5        | Can you please explain how your institution handles fraud detection and prevention?
| 6        | I cannot locate my credit card statement in your online banking platform. Need assistance.
| 7        | I've seen several payments to an online retailer whom I've never shopped from. Can you please assist me in addressing this issue?
| 8        | Help needed! Money came out of my account labeled as 'debit order.' Can you explain what this is?
| 9        | Can you please explain why money has been deducted from my account without my knowledge? I remember authorizing a 'debit order' but I didn't know what it was.
| 10       | I authorized a debit order, but wasn't expecting funds to be deducted from my account. Can you explain why this happened?
| 11       | Hey, there's a transaction made when I was travelling, and I know I didn't make it. Would you mind checking?
| 12       | How do I create a new payee when making online transactions on your website?
| 13       | What course of action should I take if I suspect fraud on my account?
| 14       | Hi, I've recently noticed several unauthorized transactions on my account. Could you help me investigate?
| 15       | I received an email asking for my account details. Is this a typical case of email fraud?
| 16       | What measures does the bank take to warn customers about potential fraud risks?
| 17       | Do you have any educational resources about fraud prevention that I can review?
| 18       | Can you guide me through setting up automatic bill payments on your website?
| 19       | How do I set up fraud alerts to my phone and email?
| 20       | I am unable to locate the 'transfer funds' option on your online banking platform.
| 21       | I noticed a debit order on my account that I don't understand. What happens when you authorize a debit order?
| 22       | I think I'm a victim of fraud. Can you help me secure my account?
| 23       | If someone tried to commit fraud involving my account, how would I be notified?
| 24       | I have received an alert for a cash transfer I did not authorize. Can you help me cancel this transaction?
| 25       | Could you explain the steps for updating my contact details in your banking application?
| 26       | Help! My account shows a payment that exceeds my set transfer limit, but I did not authorize it.
| 27       | I authorized a debit order but I don't really understand what that means. Can you please explain and tell me why my money was taken out?
| 28       | I am having trouble finding the option to set up mobile alerts. Could you assist?
| 29       | Hey, there's a large payment made to a vendor I've never done business with. What's going on?
| 30       | Can you guide me through ordering a new checkbook via your web application?
| 31       | Can you clarify how a debit order works? I authorized it and money has been taken out of my account unexpectedly.
| 32       | I spotted a suspicious foreign transaction on my account. Could you check it out, please?
| 33       | I don't understand the concept of a debit order and I'm seeing deductions on my account. Could you please explain this to me?
| 34       | I can't seem to find where to check my account balance. Could you help?
| 35       | I saw a transaction on my account that I don't recognize. Turns out I'd authorized a debit order. Can you explain what this debit order is?
| 36       | I'm unable to recognize a recurring monthly payment on my account. Can you assist with this?
| 37       | How do I reset my pin using your banking website? I can't find the option.
| 38       | Money deducted under 'debit order' and I don't understand what that means - could you kindly explain?
| 39       | Hello, I observed multiple small payments to the same recipient. Is this a fraudulent activity?
</details>
<br>

<details>
  <summary>Click here to see my answers</summary>
I will not put you through the tedium of reading 40 lines of this!
</details>
<br>

<details>
  <summary>Click here to see the Language Model's answers</summary>
I passed each customer query individually to the model. The model took an average of 1.2 seconds per query processed.

| Query ID | Query | Customer has been a victim of fraud (high likelihood)
|----------|-------|------------------
| 0 | I am noticing an unexpected increase in payments to my utility service provider. Can you help? | Maybe
| 1 | I authorized a debit order but didn't expect my funds to go out. Can customer support assist me in understanding this? | No
| 2 | How do I link my saving and checking accounts on your web application? | No
| 3 | I'd like to ensure that I have fraud protection on my account. Can you assist? | No
| 4 | Can you please clarify the steps followed to report potential fraud in my account? | Maybe
| 5 | Can you please explain how your institution handles fraud detection and prevention? | No
| 6 | I cannot locate my credit card statement in your online banking platform. Need assistance. | No
| 7 | I've seen several payments to an online retailer whom I've never shopped from. Can you please assist me in addressing this issue? | Yes
| 8 | Help needed! Money came out of my account labeled as 'debit order.' Can you explain what this is? | Maybe
| 9 | Can you please explain why money has been deducted from my account without my knowledge? I remember authorizing a 'debit order' but I didn't know what it was. | Maybe
| 10 | I authorized a debit order, but wasn't expecting funds to be deducted from my account. Can you explain why this happened? | Maybe
| 11 | Hey, there's a transaction made when I was travelling, and I know I didn't make it. Would you mind checking? | Yes
| 12 | How do I create a new payee when making online transactions on your website? | No
| 13 | What course of action should I take if I suspect fraud on my account? | Maybe
| 14 | Hi, I've recently noticed several unauthorized transactions on my account. Could you help me investigate? | Yes
| 15 | I received an email asking for my account details. Is this a typical case of email fraud? | Maybe
| 16 | What measures does the bank take to warn customers about potential fraud risks? | No
| 17 | Do you have any educational resources about fraud prevention that I can review? | No
| 18 | Can you guide me through setting up automatic bill payments on your website? | No
| 19 | How do I set up fraud alerts to my phone and email? | No
| 20 | I am unable to locate the 'transfer funds' option on your online banking platform. | No
| 21 | I noticed a debit order on my account that I don't understand. What happens when you authorize a debit order? | Maybe
| 22 | I think I'm a victim of fraud. Can you help me secure my account? | Yes
| 23 | If someone tried to commit fraud involving my account, how would I be notified? | No
| 24 | I have received an alert for a cash transfer I did not authorize. Can you help me cancel this transaction? | Yes
| 25 | Could you explain the steps for updating my contact details in your banking application? | No
| 26 | Help! My account shows a payment that exceeds my set transfer limit, but I did not authorize it. | Yes
| 27 | I authorized a debit order but I don't really understand what that means. Can you please explain and tell me why my money was taken out? | Maybe
| 28 | I am having trouble finding the option to set up mobile alerts. Could you assist? | No
| 29 | Hey, there's a large payment made to a vendor I've never done business with. What's going on? | Yes
| 30 | Can you guide me through ordering a new checkbook via your web application? | No
| 31 | Can you clarify how a debit order works? I authorized it and money has been taken out of my account unexpectedly. | No
| 32 | I spotted a suspicious foreign transaction on my account. Could you check it out, please? | Yes
| 33 | I don't understand the concept of a debit order and I'm seeing deductions on my account. Could you please explain this to me? | Maybe
| 34 | I can't seem to find where to check my account balance. Could you help? | No
| 35 | I saw a transaction on my account that I don't recognize. Turns out I'd authorized a debit order. Can you explain what this debit order is? | Maybe
| 36 | I'm unable to recognize a recurring monthly payment on my account. Can you assist with this? | Maybe
| 37 | How do I reset my pin using your banking website? I can't find the option. | No
| 38 | Money deducted under 'debit order' and I don't understand what that means - could you kindly explain? | Maybe
| 39 | Hello, I observed multiple small payments to the same recipient. Is this a fraudulent activity? | Maybe

</details>
<br>

<details>
  <summary>Click here to see the prompt which I gave to the language model</summary>
The model was prompted separately for each individual customer query. Each time, it was given the same context and the same single example as follows:

"""  
SYSTEM: 

You are an experienced cybersecurity professional working for a large bank. You have been assigned the task of classifying a set of customer queries which have been submitted directly by customers on your web-based banking platform. When presented with a user query, please answer with only a single word: 'Yes', 'No' or 'Maybe'. Please do not provide any additional information. 

USER: 

A customer submitted the following:

"Thank you so much for resolving my fraud case so quickly!"

Based on this submitted message, do you consider there to be a high likelihood that this customer is a victim of fraud? 

Please answer with exactly 1 word - "Yes", "No" or "Maybe".

ASSISTANT: 

No.

USER: 

A customer submitted the following:

&lt;new customer query goes here&gt;

Based on this submitted message, do you consider there to be a high likelihood that this customer is a victim of fraud? 

Please answer with exactly 1 word - "Yes", "No" or "Maybe".

ASSISTANT:

"""

You can view the python code which I used to get responses from the model [here](./tasks/item_triage/code/classify_customer_queries.py).
</details>
<br>

<details>
  <summary>Click here for more details about this task</summary>
I generated all of the customer queries in this task themselves using the OpenAI GPT4 model (they appear in this task unedited), with the following prompt:
<br><br>

*"Please generate 10 authentic customer queries that were submitted to the 'customer support' service of a web-based banking application. Each query should be between 5 and 50 words long. The customer queries must all be related to {topic}."*

I ran this prompt separately for each of these topics:

* {payments with suspicious attributes}
* {difficulty with the user interface (they don't know how to use the platform)}
* {absolutely normal banking activity (i.e. nothing fraudulent), but containing the word 'fraud'}

You can see my python customer query simulation code [here](./tasks/item_triage/code/simulate_customer_queries.py).
</details>
<br>


## Optimisation Task (Knapsack problem)

<figure>
  <img src="./assets/factory_crop.png" height="433" width="761"/>
  <figcaption>(This image was generated by the Stable Diffusion xl-base-1.0 model)</figcaption>
</figure>
<br>
<br>
Please decide which combination of the following facilities should be built, in order to maximise total output:

| FacilityID | Resource Usage   | Output     |
|------------|------------------|------------|
| 1          | 2                | 30         |
| 2          | 4                | 10         |
| 3          | 6                | 50         |
| 4          | 8                | 10         |
| 5          | 10               | 60         |
| 6          | 12               | 20         |
| 7          | 14               | 80         |
| 8          | 18               | 50         |

You are subject to the following constraints:

* Total resource usage (summed across all facilities) cannot exceed 30.

* No more than 1 of each facility (i.e. each FacilityID) may be built 

<details>
  <summary>Click here to see my answer</summary>
I evaluated candidate solutions {1,2,3,4,5}, {1,3,5,6} and {3,5,7}, from which the best was {3,5,7} (with a total output of 190).

I confirmed that this was the correct solution using google's [ortools](https://github.com/google/or-tools) (you can read my python code [here](./tasks/knapsack_problem/code/explicit_solution.py))

</details>
<br>

<details>
  <summary>Click here to see the language model's answer</summary>
The language model produced the correct answer in 0.64 seconds.

The language model's full (unedited) answer was:

"""
To solve this problem, we need to use a method called the Knapsack problem. This problem is a common algorithmic problem in the field of optimization and computer science. It involves selecting items with different weights and values to fit into a knapsack with a limited weight capacity. The goal is to maximize the total value of the items in the knapsack.

In this case, the "weight" is the resource usage, the "value" is the output, and the "capacity" is the total resource usage limit of 30. 

After running the Knapsack algorithm, the optimal combination of facilities to be built which will maximize total output is:

FacilityID: 1, 3, 5, 7

The total resource usage under this solution is 2 + 6 + 10 + 14 = 32, which exceeds the limit of 30. So, we need to remove one of the facilities. If we remove Facility 1, the total resource usage becomes 30 and the total output is 50 + 60 + 80 = 190.

So, the final solution is:

FacilityID: 3, 5, 7

Total Resource Usage: 30

Total Output: 190

"""

I don't know if it was fluke or not, but GPT4 absolutely smashed this task.

</details>
<br>

<details>
  <summary>Click here to see the prompt which I gave to the language model</summary>
"""

SYSTEM:

You are an insightful and educated data scientist.

USER:

The following dataset provides the attributes of 8 potential facilities which may be built. The data is in CSV format:

FacilityID,Resource Usage,Output<br>
1,2,30<br>
2,4,10<br>
3,6,50<br>
4,8,10<br>
5,10,60<br>
6,12,20<br>
7,14,80<br>
8,18,50<br>

Given that the sum of total resource usage across all facilities cannot exceed 30 and that no more than 1 of each facility may be built, please report the combination of facilities to be built which will maximise total output. You may report the Facility IDs without providing any explanation for your answer. Please also report the total resource usage and total output under your proposed solution.

"""
</details>
<br>

<details>
  <summary>Click here for more details about this task</summary>
The facility attributes were generated by ChatGPT3.5 using the following prompt: "Can you please generate an example knapsack problem for me please? One in which there is one knapsack and 8 possible items to pack."

In case the generated problem was very similar to an example appearing in ChatGPT3.5's training data (which might give a GPT model an unfair advantage in answering the question), after getting the model's response I changed the order of rows and columns in the table, renamed the columns, divided each facility output by 3 and doubled each facility resource usage.

My python code for this task:

[llm_solution.py](./tasks/knapsack_problem/code/llm_solution.py)

</details>
<br>

## Things I Learned 

Here are some things that occurred to me while writing this blog post:

* I probably should have just asked GPT4 to write the entire blog post for me, at least as a starting point. 

* GPT4 seems very well-suited to tasks which involve understanding or generating natural language. Other examples of natural language tasks are sentiment analysis, intent classification, question answering and document drafting. GPT4 shows remarkable ability in numerical and data domains, but I don't trust it's output enough to use it without review.

* GPT4 is great for simulating fake (but plausible) data.

* GPT4 is very good at writing code. However, I don't believe that it writes particularly readable or maintainable code. I think that this is an artifact of it's training data - most of the code on the internet is not that great.

* It seems implausible to me that GPT4 is doing only next-token prediction. I don't think that it would be able to perform floating point arithmetic or identify a reworded knapsack problem without some sort of self-reflection mechanism and/or access to tools (e.g. a calculator).  

Here are some other things (which I didn't end up including) which I've seen people claim that large language models are good at:

* Creating personalised marketing content (e.g. a unique message for every customer)
* Facilitating a question-answering chatbot (or just question answering)
* Content creation (blog posts, social media posts, article titles etc.)
* Providing feedback on text (e.g. find spelling errors, comment on style etc.)
* Assisting customers (e.g. with a checkout journey) by referencing documentation.
* Analysing financial reports
* Document question-answering
* Summarising text
* Document drafting (e.g. an email, or a legal contract)
* Generating personalized recommendations
* Screening resumes
* Answering customer queries from a large knowledge base
* Booking appointments
* Providing product information
* Sentiment Analysis
* Predictive analytics 
* Double-checking human decisions (or providing suggestions) e.g. medical diagnosis
* Tracking and analysing customer feedback
* Querying structured data (e.g. how is my marketing campaign going?)